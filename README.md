# Msc_thesis
This repository include all R script, data, table, and figures used in my thesis entitled "A group sequential three-arm two-stage trial design with rank-based endpoints"
## File description
# R script
1. FUNCTIONS.R contains necessary functions to run the simulations and generate the tables and figures in Section 9 of my thesis.
   - sim_rfc_MJW, sim_rfc_MJW-DTL, sim_rfc_AS, sim_rfc_AS-DTL are core functions used to simulate data for four stopping rules,
   - prob_cal can be used for Type I error calculation and prob_cal_power_others can be used to calculation power and other selection probabilities,
   - findBoundary_alphas_optim is used to compute the optimal boundary values based on Nelder-Mead method,
   - power_wrapper_with_boundary wraps the boundary finding and power calculation, which can be used to calculate the boundary values and corresponding power under different sample sizes
   - Threearm_twostage_design can be seen as a sample size finding function, which wraps boundaries finding, calculations of error, power and other probabilities, and sample size finder all together. It is the most important and comprehensive function.
2. SECTION(section number)_RSCRIPT.R contain R scripts used to call functions, run simulations and generate results for each subsection under section 9.
   - SECTION9_2_RSCRIPT.R runs the simulation and generates the results for Table 1,
   - SECTION9_3_RSCRIPT.R runs the simulation and generates the results for Table 2,
   - SECTION9_4_RSCRIPT.R runs the simulation and generates the results for Table 3,
   - SECTION9_5_RSCRIPT.R runs the simulation and generates the results for Table 4.
3. Nelder-Mead_RSCRIPT.R contain the simulation based on the grid search method and the 3D plotting process for Figure 6 and 7.
# Data
1. TABLE(table number)_DATA.rds contain the data used to generate corresponding tables
   - TABLE1_DATA.rds contains data for Table 1. It is generated by SECTION9_2_RSCRIPT.R.
   - TABLE2_DATA.rds contains data for Table 2. It is generated by SECTION9_3_RSCRIPT.R.
   - TABLE3_DATA.rds contains data for Table 3. It is generated by SECTION9_4_RSCRIPT.R.
   - TABLE4_DATA.rds contains data for Table 4. It is generated by SECTION9_5_RSCRIPT.R.
   - TABLE5_DATA.rds contains data for Table 5 in Appendix A.2. It is generated by SECTION9_2_RSCRIPT.R.
   - Data_Nelder-Mead.rds contains data for plotting Figure 6 and 7. It is generated and used in Nelder-Mead_RSCRIPT.R
